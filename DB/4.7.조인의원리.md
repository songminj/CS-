# 4.7 조인의 수행 원리 

## 4.7.1 중첩 루프 조인 (Nested Loop Join)

> Q. 중첩루프 조인은 무엇인가? 

A. 중첩 루프 조인은 중첩 for문과 같은 원리로 조건에 맞는 조인을 하는 방법이다. 

IDOL_GROUP, IDOL_MEMBER이라는 테이블이 있고 GROUP_NAME이 공통키라고 하자. [pick for group in IDOL_GROUP for member in IDOL_MEMBER if group.groupname == member.membername] 조인 수행 방식이 이런 식이다. 
한건 갈때마다 전부 full scan을 해야하기 때문에 대량의 테이블을 JOIN하는 방식으로는 적절하지 않다. 1:M관계에서 소량의 테이블이 OuterJoin이 되는 것이 유리하다. 



## 4.7.2 정렬 병합 조인

> Q. 정렬 병합 조인

A. 중첩 for문과 유사하지만 우선 join 컬럼을 기준으로 sorting하는 것이다. 그 다음에 sorting을 하는 것이다. Inner Table쪽에 적절한 인덱스가 없어서 Nested Loop Join을 쓰기에 부적절할때 사용한다 조인조건으로 <나 > 등 범위비교 연산자가 있을 때 쓴다. 

Equal Join이 아니라 범위로 Join을 하는 경우 적절한 쿼리 수행이라고 할 수 있다. PGA영역에서 발생하기 때문에 경합이 발생하지 않아 성능에 유리한 면이 있다. 


> Q. PGA란 무엇인가?

A. PGA란 데이터베이스에 접속하는 모든 유저에 할당되는 각각의 서버 프로세스가 독자적으로 사용하는 오라클 메모리 영역 

## 4.7.3 해시 조인 

> Q. 해시 조인이란 무엇인가?

A. 해시 테이블을 기반으로 조인하는 방법이다. 보통 대용량 테이블에서 사용한다. Join 컬럼을 기준으로 Hash Function이 적용되기 때문에 key컬럼에 중복값이 없을수록 성능이 유리하다. 조인이 어떻게 풀리고 있는지 확인하려면 실행계획을 확인하면 된다. 오라클 힌트를 써서 다른 수행방법으로 바꿔 볼 수 있다. 더 좋은 성능의 방법으로 튜닝하면 된다. 


> Q. MySQL의 해시조인단계를 설명하라 

A. 첫번째는 빌드단계이다. 입력 테이블 중 하나를 기반으로 메모리 내 해시테이블을 빌드하는 단계이다. 더 작은 테이블을 기반으로하는게 성능면에서 유리하다. 
두번째는 probe단계이다. 두번째 테이블을 처리한다. 해시 테이블을 기반으로 일치하는 레코드를 찾아서 결과값을 반환한다. 
