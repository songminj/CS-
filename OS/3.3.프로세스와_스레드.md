# 3.3 프로세스와 스레드 

프로세스 : 컴퓨터에서 실행되고 있는 프로그램을 말한다. CPU스케줄링의 대상이 되는 작업이라는 용어와 거의 갚은 의미로 쓰인다.

스레드 : 프로세스 내 작업의 흐름을 지칭한다. 

## 3.3.1 프로세스와 컴파일 과정 

> 프로세스에 대해 설명하라 

- 프로세스는 프로그램으로부터 인스턴스화된 것을 말한다. 예를 들어 프로그램은 구글 크롬 프로그램과 같은 실행파일이다. 이걸 실행하면 구글 크롬 프로세스가 시작되는 것이다. 
- 프로그램은 컴파일러가 컴파일 과정을 거쳐 컴퓨터가 이해할 수 있는 기계어로 번역되어 실행될 수 있는 파일을 의미한다. 

- 전처리 : 소스 코드의 주석을 제거하고 #include등 헤더 파일을 병합하여 매크로를 치환한다. 
- 컴파일러 : 오류 처리, 코드 최적화 작업을 하며 어셈블리어로 변환한다. 
- 어셈블러 : 어셈블리어는 목적 코드로 변환된다. 이때 확장자는 운영체제마다 다른데, 리눅스에서는 .o이다. 
- 링커 : 프로그램 내에 있는 라이브러리 함수, 또는 목적 파일들과 목적 코드를 결합하여 실행 파일을 만든다. .exe, .out이라는 확장자를 가진다. 


> 정적 라이브러리와 동적 라이브러리

- 정적 라이브러리 : 프로그램 빌드 시 라이브러리가 제공하는 모든 코드를 실행 파일에 넣는 방식이다. 시스템 환경 등 외부 의존도가 낮고 코드 중복등 메모리 효율성이 떨어진다 
- 동적 라이브러리 : 프로그램 실행 시 필요할 때만 DLL이라는 함수 정보를 통해 참조하는 방식이며, 메모리 효율성에서의 장점과 외부 의존도가 높아진다는 단점이 있다.  



## 3.3.2 프로세스의 상태 


- 생성상태 : create. 프로세스가 생성된 상태를 의미하며 fork(), exec() 함수를 통해 생성한다. 이때 PCB가 할당된다. 
  - PCB : 프로세스 제어 블록. 특정한 프로세스를 관리할 필요가 있는 정보를 포함하는 운영체제 커널의 자료구조이다. 
  - fork() : 부모 프로세스의 주소 공간을 그대로 복사하며, 새로운 자식 프로세스를 생성하는 함수이다. 주소 공간만 복사할 뿐이지, 부모 프로세스의 비동기 작업등을 상속하지 않는다. 
  - exec() : 새롭게 프로세스를 생성하는 함수이다. 
- 대기 상태 : 메모리 공간이 충분하면 메모리를 할당받고, 아니면 아닌 상태로 대기하고 있으며 CPU 스케줄러로부터 CPU 소유권이 넘어오기를 기다리는 상태이다. 
- 대기 중단 상태 : 메모리 부족으로 일시 중단된 상태 
- 실행 상태 : CPU 소유권과 메모리를 할당받고 인스트럭션을 수행중인 상태를 의미한다. 
- 중단 상태 : 어떤 이벤트가 발생한 이후 기다리며 프로세스가 차단된 상태. 
- 일시 중단 상태 : 중단 상태에서 메모리 부족으로 일시 중단된 상태 
- 종료 상태 : 메모리와 CPU소유권을 모두 두고간다. .kill 명령어로 프로세스를 종료할 때 발생한다. 



## 3.3.3 프로세스의 메모리 구조 

운영체제는 프로세스에 적절한 메모리를 할당하는데 다음 구조를 기반으로 할당한다. 


### 동적 영역 

1. 스택

- 위 주소부터 할당된다
- 지역변수, 매개변수, 함수가 저장된다. 
- 컴파일 시에 크기가 결정되며 동적인 특징을 갖는다. 
- 함수가 재귀적으로 움직이면 동적으로 크기가 늘어날 수가 있는데, 이때 힙과 스택의 메모리 영역이 겹치면 안되기 때문에 힙과 스택 사이의 공간으리 비워놓는다. 

2. 힙

- 아래 주소부터 할당된다. 
- 런타임시 크기가 결정된다
- 벡터같은 동적 배열은 당연히 힙에 동적할당 된다. 



### 정적 영역 

3. 데이터 영역 
- 전역 변수, 정적 변수가 저장되고 정적인 특징을 갖는 프로그램이 종료되면 사라지는 변수가 들어있다. 
  - BSS영역 : 초기화되지 않은 변수가 0으로 초기화되어 저장된다
  - Data영역 : 0이 아닌 다른 값으로 할당된 변수들이 저장된다. 


4. 코드 영역 

- 내장 소스코드가 들어가있는 영역이다
- 수정 불가능한 기계어로 저장되어 있고 정적인 특징을 가진다. 


### 3.3.4 PCB

> PCB에 대해 설명해라 

- 운영체제에서 프로세스에 대한 메타 데이터를 저장한 '데이터'를 말한다. 프로세스 제어 블록. 
- 프로세스가 생성되면 운영체제는 해당 PCB를 생성한다 
- PCB는 프로세스 스케줄링 상태, PID(프로세스 아이디), 권한, 프로그램 카운터, CPU레지스터, CPU스케줄링 정보, 계정정보 I/O상태 정보등을 가지고 있다. 

> 컨텍스트 스위칭 

- PCB를 교환하는 과정 
- 어떤 시점에서 실행되고 있는 프로세스는 단 한개이며 많은 프로세스가 동시에 구동되는 것철머 보이는 것은 다른 프로세스와의 컨텍스트 스위칭이 아주 빠른 속도로 실행되고 있기 때문이다



### 3.3.5 멀티프로세싱

> 멀티 프로세스를 설명하라 

- 여러개의 프로세스를 수행할 수 있는 것을 말한다. 하나 이상의 일을 병렬로 처리할 수 있으며 특정 프로세스의 메모리, 프로세스 중 일부에 문제가 발생되더라도 다른 프로세스를 이용해서 처리할 수 있으므로 신뢰성이 높은 강점이 있다. 

> IPC

- 멀티 프로세스는 IPC가 가능하며 IPc는 프로세스끼리 데이터를 주고받고 공유데이터를 관리하는 매커니즘을 뜻한다.













